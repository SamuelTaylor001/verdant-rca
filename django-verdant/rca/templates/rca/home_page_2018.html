{% extends "rca/full_width.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
{% endblock %}


{% block content %}
    {% include "rca/includes/sprites.html" %}

    <p>Use 2018 template: {{ use_2018_redesign_template }}</p>

    <a href="{{ header_navigation_links.navigation_link_1_url }}">{{ header_navigation_links.navigation_link_1_text }}</a>
    <a href="{{ header_navigation_links.navigation_link_2_url }}">{{ header_navigation_links.navigation_link_2_text }}</a>

    {# Hero fields #}
    <p>{{ self.hero_text }}</p>
    {% image self.hero_image original %}

    {# WIP Programme Finder #}
    <section style="border: 1px solid black; padding:20px;">
        <h2>Study at RCA</h2>
        {% if last_viewed_programme %}
            <h3>Recently viewed: <a href="{% pageurl last_viewed_programme %}">{{ last_viewed_programme }}</a></h3>
        {% endif %}
        <p>Search {{ programme_count }} distinctive postgraduate programmes</p>
        <input type="text" name="course_search" id="course_search" placeholder="Enter a programme title">

        {# Browse all programmes link needs a ProgrammeFinderPage to exist #}
        {% if programme_finder_page_url %}<p><a href="{{ programme_finder_page_url }}">Browse our programmes -></a></p>{% endif %}
    </section>

    {% include_block self.body %}

    {% include "rca/includes/modules/twitter-feed.html" %}
{% endblock %}




{% block extra_js %}
    
    {# showcase carousel using slick #}
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script type="text/javascript">

        // Home page carousel
        var prevButton = '<button aria-label="Previous" class="slider__button slider__button--prev" type="button"><svg class="slider__arrow slider__arrow--prev"><title>Previous</title><use xlink:href="#chevron"></use></svg></button>';
        var nextButton = '<button aria-label="Next" class="slider__button slider__button--next" type="button"><svg class="slider__arrow slider__arrow--next"><title>Previous</title><use xlink:href="#chevron"></use></svg></button>';

        // Showcase carousel
        var $slider = $('.js-showcase');

        $slider.slick({
            // medium and large desktop
            prevArrow: prevButton,
            nextArrow: nextButton,
            centerMode: true,
            infinte:true,
            slidesToShow: 3,
            responsive: [
                {
                    // small desktop / mobile
                    breakpoint: 1024,
                    settings: {
                        centerMode: true,
                        centerPadding: '40px',
                        slidesToShow: 1
                    }
                }
            ]
        });

        // Testimonial carousel
        var $testimonialSlider = $('.js-testimonial');

        $testimonialSlider.slick({
            // medium and large desktop
            prevArrow: prevButton,
            nextArrow: nextButton,
            infinte:true,
            dots: true,
            slidesToShow: 1
        });

        //WIP Programme Finder
        $(function() {
            $("input#course_search").autocomplete({
                minLength: 3,
                source: function(request, response) {
                    $.getJSON("/programme_search/?q=" + request.term, function(data) {
                        response(data);
                    });
                },
                select: function( event, ui ) {
                    window.location.href = ui.item.search_url || ui.item.url;
                }
            }).data("ui-autocomplete")._renderItem = function( ul, item ) {
                return $( "<li></li>" ).data( "item.autocomplete", item ).append( "<a>" + item.title + "</a>" ).appendTo( ul );
            };
        });
    </script>
{% endblock %}
