{% load wagtailcore_tags wagtailimages_tags static %}

{% if search_results %}
    <section class="x-plus row module" data-pagination=".pagination">
        <div class="item-container">
            <ul>
                {% for result in search_results %}
                    {% with result_specific=result.specific %}
                        <li class="row">
                            <a href="{% pageurl result_specific %}">
                                <div class="image">
                                    {% if result_specific.feed_image %}
                                        {% image result_specific.feed_image fill-180x160 %}
                                    {% else %}
                                        <img src="{% static 'rca/images/rca-placeholder-square.jpg' %}"
                                             width="180">
                                    {% endif %}
                                </div>
                                <div class="content">
                                    <h4 class="h6">{{ result_specific }}</h4>

                                    {% comment %}
                                    Note that we need to call the richtext filter here anyway,
                                    because we want to display ampersands correctly
                                    and make sure that all internal link representations
                                    were converted into valid html
                                    {% endcomment %}
                                    {{ result_specific.intro|richtext|striptags|truncatewords_html:50 }}
                                </div>
                            </a>
                        </li>
                    {% endwith %}
                {% endfor %}
                {% if search_results.paginator.count > paginator_page_size %}
                    <li class="load-more"><a href="#">+</a></li>
                {% endif %}
            </ul>
        </div>
    </section>

    {% if search_results.has_previous or search_results.has_next %}
        <ul class="row pagination infinite">
            {% if search_results.has_next %}
                <li class="next">
                    <a href="?p={{ search_results.next_page_number }}{% for key,value in request.GET.items %}{% if key != 'p' %}&{{ key }}={{ value }}{% endif %}{% endfor %}">
                        Next
                    </a>
                </li>
            {% endif %}
        </ul>
    {% endif %}

{% endif %}